import{p as Be,u as be,B as S,C as oe,y as ie,z as se,o as C,l as L,b as f,m as X,D as $,E as F,q as y,x as M,G as E,I as N,f as O,g as Ae,v as Re,F as Se,j as H,A as ne,J as Oe,K as I,M as Ee,w as _,d as m,a as z,e as v,t as w,c as P,n as Ze,s as Pe,i as Ie,H as Fe,h as Ue,L as De}from"./app.cea855f7.js";import{_ as Ke}from"./Authenticated.d169710d.js";import{T as Ge}from"./Table.c99bc67c.js";import{_ as Q}from"./Actions.5787c160.js";import{_ as K}from"./Input.50e47f58.js";import{_ as T}from"./Button.06d19c4a.js";import{_ as me}from"./Select.b725302a.js";import{u as He}from"./useAlerts.6e7215ec.js";import{_ as Je}from"./Pagination.765da988.js";const le=Be("cities",{state:()=>({dialog:!1,isEdit:!1,editMap:!1,form:be({id:"",name:"",zipcode:"",currency:"gbp",unit:"mi",country_id:"",radius:"",coords:[]}),center:{lat:57.477772,lng:-4.224721}})});let B=Symbol("map"),A=Symbol("api"),Le=Symbol("marker"),je=Symbol("markerCluster"),J=Symbol("CustomMarker"),ze=Symbol("mapTilesLoaded"),q="click dblclick drag dragend dragstart mousedown mousemove mouseout mouseover mouseup rightclick".split(" ");var We=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r;if(Array.isArray(e)){var o=e.length;if(o!=t.length)return!1;for(r=o;r--!==0;)if(!i(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[r]))return!1;for(r=o;r--!==0;)if(o=s[r],!i(e[o],t[o]))return!1;return!0}return e!==e&&t!==t};class j{constructor({apiKey:e,channel:t,client:r,id:o="__googleMapsScriptId",libraries:s=[],language:u,region:l,version:c,mapIds:a,nonce:n,retries:d=3,url:p="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.loading=this.done=!1,this.errors=[],this.version=c,this.apiKey=e,this.channel=t,this.client=r,this.id=o||"__googleMapsScriptId",this.libraries=s,this.language=u,this.region=l,this.mapIds=a,this.nonce=n,this.retries=d,this.url=p,j.instance){if(!We(this.options,j.instance.options))throw Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(j.instance.options)}`);return j.instance}j.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),0<this.libraries.length&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),e}deleteScript(){let e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(r=>{r?t(r.error):e(window.google)})})}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id))this.callback();else{var e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}}reset(){this.deleteScript(),this.loading=this.done=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){this.errors.push(e),this.errors.length<=this.retries?(e=this.errors.length*Math.pow(2,this.errors.length),console.log(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)):(this.onerrorEvent=e,this.callback())}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){this.resetIfRetryingFailed(),this.done?this.callback():window.google&&window.google.maps&&window.google.maps.version?(console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback()):this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}function Xe(i){return class extends i.OverlayView{constructor(e){super();let{element:t,...r}=e;this.element=t,this.opts=r,this.opts.map&&this.setMap(this.opts.map)}getPosition(){return this.opts.position?this.opts.position instanceof i.LatLng?this.opts.position:new i.LatLng(this.opts.position):null}getVisible(){if(!this.element)return!1;let e=this.element;return e.style.display!=="none"&&e.style.visibility!=="hidden"&&(e.style.opacity===""||.01<Number(e.style.opacity))}onAdd(){if(this.element){var e=this.getPanes();e&&e.overlayMouseTarget.appendChild(this.element)}}draw(){if(this.element){var e=this.getProjection().fromLatLngToDivPixel(this.getPosition());if(e){this.element.style.position="absolute";let r=this.element.offsetHeight;var t=this.element.offsetWidth;switch(this.opts.anchorPoint){case"TOP_CENTER":t=e.x-t/2,e=e.y;break;case"BOTTOM_CENTER":t=e.x-t/2,e=e.y-r;break;case"LEFT_CENTER":t=e.x,e=e.y-r/2;break;case"RIGHT_CENTER":t=e.x-t,e=e.y-r/2;break;case"TOP_LEFT":t=e.x,e=e.y;break;case"TOP_RIGHT":t=e.x-t,e=e.y;break;case"BOTTOM_LEFT":t=e.x,e=e.y-r;break;case"BOTTOM_RIGHT":t=e.x-t,e=e.y-r;break;default:t=e.x-t/2,e=e.y-r/2}this.element.style.left=t+"px",this.element.style.top=e+"px",this.element.style.transform=`translateX(${this.opts.offsetX||0}px) translateY(${this.opts.offsetY||0}px)`,this.opts.zIndex&&(this.element.style.zIndex=this.opts.zIndex.toString())}}}onRemove(){this.element&&this.element.remove()}setOptions(e){this.opts=e,this.draw()}}}let he,fe="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed".split(" ");var ae=S({props:{apiPromise:{type:Promise},apiKey:{type:String,default:""},version:{type:String,default:"weekly"},libraries:{type:Array,default:()=>["places"]},region:{type:String,required:!1},language:{type:String,required:!1},backgroundColor:{type:String,required:!1},center:{type:Object,default:()=>({lat:0,lng:0})},clickableIcons:{type:Boolean,required:!1,default:void 0},controlSize:{type:Number,required:!1},disableDefaultUi:{type:Boolean,required:!1,default:void 0},disableDoubleClickZoom:{type:Boolean,required:!1,default:void 0},draggable:{type:Boolean,required:!1,default:void 0},draggableCursor:{type:String,required:!1},draggingCursor:{type:String,required:!1},fullscreenControl:{type:Boolean,required:!1,default:void 0},fullscreenControlPosition:{type:String,required:!1},gestureHandling:{type:String,required:!1},heading:{type:Number,required:!1},keyboardShortcuts:{type:Boolean,required:!1,default:void 0},mapTypeControl:{type:Boolean,required:!1,default:void 0},mapTypeControlOptions:{type:Object,required:!1},mapTypeId:{type:[Number,String],required:!1},mapId:{type:String,required:!1},maxZoom:{type:Number,required:!1},minZoom:{type:Number,required:!1},noClear:{type:Boolean,required:!1,default:void 0},panControl:{type:Boolean,required:!1,default:void 0},panControlPosition:{type:String,required:!1},restriction:{type:Object,required:!1},rotateControl:{type:Boolean,required:!1,default:void 0},rotateControlPosition:{type:String,required:!1},scaleControl:{type:Boolean,required:!1,default:void 0},scaleControlStyle:{type:Number,required:!1},scrollwheel:{type:Boolean,required:!1,default:void 0},streetView:{type:Object,required:!1},streetViewControl:{type:Boolean,required:!1,default:void 0},streetViewControlPosition:{type:String,required:!1},styles:{type:Array,required:!1},tilt:{type:Number,required:!1},zoom:{type:Number,required:!1},zoomControl:{type:Boolean,required:!1,default:void 0},zoomControlPosition:{type:String,required:!1}},emits:fe,setup(i,{emit:e}){let t=y(),r=y(!1),o=y(),s=y(),u=y(!1);F(B,o),F(A,s),F(ze,u);let l=()=>{const n={...i};Object.keys(n).forEach(p=>{n[p]===void 0&&delete n[p]});var d=p=>{var h;return p?{position:(h=s.value)===null||h===void 0?void 0:h.ControlPosition[p]}:{}};return d={scaleControlOptions:i.scaleControlStyle?{style:i.scaleControlStyle}:{},panControlOptions:d(i.panControlPosition),zoomControlOptions:d(i.zoomControlPosition),rotateControlOptions:d(i.rotateControlPosition),streetViewControlOptions:d(i.streetViewControlPosition),fullscreenControlOptions:d(i.fullscreenControlPosition),disableDefaultUI:i.disableDefaultUi},{...n,...d}},c=E([s,o],([n,d])=>{n&&d&&(n.event.addListenerOnce(d,"tilesloaded",()=>{u.value=!0}),setTimeout(c,0))},{immediate:!0}),a=n=>{s.value=I(n.maps),o.value=I(new n.maps.Map(t.value,l())),n=Xe(s.value),s.value[J]=n,fe.forEach(d=>{var p;(p=o.value)===null||p===void 0||p.addListener(d,h=>e(d,h))}),r.value=!0,n=Object.keys(i).filter(d=>!"apiPromise apiKey version libraries region language center zoom".split(" ").includes(d)).map(d=>$(i,d)),E([()=>i.center,()=>i.zoom,...n],([d,p],[h,g])=>{var k,x,b;const{center:ce,zoom:Y,...Ne}=l();(k=o.value)===null||k===void 0||k.setOptions(Ne),p!==void 0&&p!==g&&((x=o.value)===null||x===void 0||x.setZoom(p)),p=!h||d.lng!==h.lng||d.lat!==h.lat,d&&p&&((b=o.value)===null||b===void 0||b.panTo(d))})};return ne(()=>{if(i.apiPromise&&i.apiPromise instanceof Promise)i.apiPromise.then(a);else{try{const{apiKey:n,region:d,version:p,language:h,libraries:g}=i;he=new j({apiKey:n,region:d,version:p,language:h,libraries:g})}catch(n){console.error(n)}he.load().then(a)}}),N(()=>{var n;u.value=!1,o.value&&((n=s.value)===null||n===void 0||n.event.clearInstanceListeners(o.value))}),{mapRef:t,ready:r,map:o,api:s,mapTilesLoaded:u}}});function ue(i,e){if(e===void 0&&(e={}),e=e.insertAt,i&&typeof document!="undefined"){var t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}ue(`
.mapdiv[data-v-177d06e3] {
  width: 100%;
  height: 100%;
}
`);let Ye=oe();ie("data-v-177d06e3");let Qe={ref:"mapRef",class:"mapdiv"};se();let et=Ye(i=>(C(),L("div",null,[f("div",Qe,null,512),X(i.$slots,"default",{ready:i.ready,map:i.map,api:i.api,mapTilesLoaded:i.mapTilesLoaded},void 0,!0)])));ae.render=et;ae.__scopeId="data-v-177d06e3";var D=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r;if(Array.isArray(e)){var o=e.length;if(o!=t.length)return!1;for(r=o;r--!==0;)if(!i(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[r]))return!1;for(r=o;r--!==0;)if(o=s[r],!i(e[o],t[o]))return!1;return!0}return e!==e&&t!==t};let R=(i,e,t,r)=>{const o=y(),s=M(B,y()),u=M(A,y()),l=M(je,y()),c=H(()=>!!(l.value&&u.value&&(o.value instanceof u.value.Marker||o.value instanceof u.value[J])));return E([s,t],(a,[n,d])=>{var p,h,g;a=!D(t.value,d)||s.value!==n,s.value&&u.value&&a&&(o.value?(o.value.setOptions(t.value),c.value&&((p=l.value)===null||p===void 0||p.removeMarker(o.value),(h=l.value)===null||h===void 0||h.addMarker(o.value))):(o.value=i==="Marker"?I(new u.value[i](t.value)):i===J?I(new u.value[i](t.value)):I(new u.value[i]({...t.value,map:s.value})),c.value?(g=l.value)===null||g===void 0||g.addMarker(o.value):o.value.setMap(s.value),e.forEach(k=>{var x;(x=o.value)===null||x===void 0||x.addListener(k,b=>r(k,b))})))},{immediate:!0}),N(()=>{var a,n;o.value&&((a=u.value)===null||a===void 0||a.event.clearInstanceListeners(o.value),c.value?(n=l.value)===null||n===void 0||n.removeMarker(o.value):o.value.setMap(null))}),o},ve="animation_changed click dblclick rightclick dragstart dragend drag mouseover mousedown mouseout mouseup draggable_changed clickable_changed contextmenu cursor_changed flat_changed rightclick zindex_changed icon_changed position_changed shape_changed title_changed visible_changed".split(" ");S({name:"Marker",props:{options:{type:Object,required:!0}},emits:ve,setup(i,{emit:e,expose:t,slots:r}){return i=$(i,"options"),e=R("Marker",ve,i,e),F(Le,e),t({marker:e}),()=>{var o;return(o=r.default)===null||o===void 0?void 0:o.call(r)}}});S({name:"Polyline",props:{options:{type:Object,required:!0}},emits:q,setup(i,{emit:e}){return i=$(i,"options"),{polyline:R("Polyline",q,i,e)}},render:()=>null});var tt=S({name:"Polygon",props:{options:{type:Object,required:!0}},emits:q,setup(i,{emit:e}){return i=$(i,"options"),{polygon:R("Polygon",q,i,e)}},render:()=>null});let ge=q.concat(["bounds_changed"]);S({name:"Rectangle",props:{options:{type:Object,required:!0}},emits:ge,setup(i,{emit:e}){return i=$(i,"options"),{rectangle:R("Rectangle",ge,i,e)}},render:()=>null});let ye=q.concat(["center_changed","radius_changed"]);S({name:"Circle",props:{options:{type:Object,required:!0}},emits:ye,setup(i,{emit:e}){return i=$(i,"options"),{circle:R("Circle",ye,i,e)}},render:()=>null});var rt=S({props:{position:{type:String,required:!0},index:{type:Number,default:1}},emits:["content:loaded"],setup(i,{emit:e}){let t=y(null),r=M(B,y()),o=M(A,y()),s=M(ze,y(!1)),u=y(!1),l=E([s,o,t],([n,d,p])=>{d&&n&&p&&(c(i.position),u.value=!0,e("content:loaded"),setTimeout(l,0))},{immediate:!0}),c=n=>{r.value&&o.value&&t.value&&r.value.controls[o.value.ControlPosition[n]].push(t.value)},a=n=>{if(r.value&&o.value){let d=null;n=o.value.ControlPosition[n],r.value.controls[n].forEach((p,h)=>{p===t.value&&(d=h)}),d!==null&&r.value.controls[n].removeAt(d)}};return N(()=>a(i.position)),E(()=>i.position,(n,d)=>{a(d),c(n)}),E(()=>i.index,n=>{n&&t.value&&(t.value.index=i.index)}),{controlRef:t,showContent:u}}});let ot={ref:"controlRef"};rt.render=function(i){return C(),L(Se,null,[O(`
    v-show must be used instead of v-if otherwise there
    would be no rendered content pushed to the map controls
  `),Ae(f("div",ot,[X(i.$slots,"default")],512),[[Re,i.showContent]])],2112)};let ke="closeclick content_changed domready position_changed visible zindex_changed".split(" ");var Te=S({inheritAttrs:!1,props:{options:{type:Object,default:()=>({})}},emits:ke,setup(i,{slots:e,emit:t}){let r=y(),o=y(),s=M(B,y()),u=M(A,y()),l=M(Le,y()),c,a=H(()=>{var n;return(n=e.default)===null||n===void 0?void 0:n.call(e).some(d=>d.type!==Ee)});return ne(()=>{E([s,()=>i.options],([,n],[d,p])=>{d=!D(n,p)||s.value!==d,s.value&&u.value&&d&&(r.value?(r.value.setOptions({...n,content:a.value?o.value:n.content}),l.value||r.value.open({map:s.value})):(r.value=I(new u.value.InfoWindow({...n,content:a.value?o.value:n.content})),l.value?c=l.value.addListener("click",()=>{r.value&&r.value.open({map:s.value,anchor:l.value})}):r.value.open({map:s.value}),ke.forEach(h=>{var g;(g=r.value)===null||g===void 0||g.addListener(h,k=>t(h,k))})))},{immediate:!0})}),N(()=>{var n;c&&c.remove(),r.value&&((n=u.value)===null||n===void 0||n.event.clearInstanceListeners(r.value),r.value.close())}),{infoWindow:r,infoWindowRef:o,hasSlotContent:a}}});ue(`
.info-window-wrapper[data-v-5b373d6e] {
  display: none;
}
.mapdiv .info-window-wrapper[data-v-5b373d6e] {
  display: inline-block;
}
`);let it=oe();ie("data-v-5b373d6e");let st={key:0,class:"info-window-wrapper"};se();let nt=it(i=>i.hasSlotContent?(C(),L("div",st,[f("div",Oe({ref:"infoWindowRef"},i.$attrs),[X(i.$slots,"default",{},void 0,!0)],16)])):O("v-if",!0));Te.render=nt;Te.__scopeId="data-v-5b373d6e";function te(i,e,t,r,o,s){if(!(o-r<=t)){var u=r+o>>1;Ve(i,e,u,r,o,s%2),te(i,e,t,r,u-1,s+1),te(i,e,t,u+1,o,s+1)}}function Ve(i,e,t,r,o,s){for(;o>r;){if(600<o-r){var u=o-r+1,l=t-r+1,c=Math.log(u),a=.5*Math.exp(2*c/3);c=.5*Math.sqrt(c*a*(u-a)/u)*(0>l-u/2?-1:1),Ve(i,e,t,Math.max(r,Math.floor(t-l*a/u+c)),Math.min(o,Math.floor(t+(u-l)*a/u+c)),s)}for(u=e[2*t+s],l=r,a=o,Z(i,e,r,t),e[2*o+s]>u&&Z(i,e,r,o);l<a;){for(Z(i,e,l,a),l++,a--;e[2*l+s]<u;)l++;for(;e[2*a+s]>u;)a--}e[2*r+s]===u?Z(i,e,r,a):(a++,Z(i,e,a,o)),a<=t&&(r=a+1),t<=a&&(o=a-1)}}function Z(i,e,t,r){ee(i,t,r),ee(e,2*t,2*r),ee(e,2*t+1,2*r+1)}function ee(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}let lt=i=>i[0],at=i=>i[1];class xe{constructor(e,t=lt,r=at,o=64,s=Float64Array){this.nodeSize=o,this.points=e;let u=this.ids=new(65536>e.length?Uint16Array:Uint32Array)(e.length);s=this.coords=new s(2*e.length);for(let l=0;l<e.length;l++)u[l]=l,s[2*l]=t(e[l]),s[2*l+1]=r(e[l]);te(u,s,o,0,u.length-1,0)}range(e,t,r,o){{var s=this.ids,u=this.coords,l=this.nodeSize;let a=[0,s.length-1,0],n=[],d,p;for(;a.length;){var c=a.pop();let h=a.pop(),g=a.pop();if(h-g<=l){for(c=g;c<=h;c++)d=u[2*c],p=u[2*c+1],d>=e&&d<=r&&p>=t&&p<=o&&n.push(s[c]);continue}let k=Math.floor((g+h)/2);d=u[2*k],p=u[2*k+1],d>=e&&d<=r&&p>=t&&p<=o&&n.push(s[k]);let x=(c+1)%2;(c===0?e<=d:t<=p)&&(a.push(g),a.push(k-1),a.push(x)),(c===0?r>=d:o>=p)&&(a.push(k+1),a.push(h),a.push(x))}e=n}return e}within(e,t,r){{var o=this.ids,s=this.coords,u=this.nodeSize;let d=[0,o.length-1,0],p=[],h=r*r;for(;d.length;){var l=d.pop();let g=d.pop();var c=d.pop();if(g-c<=u){for(l=c;l<=g;l++){c=s[2*l]-e;var a=s[2*l+1]-t;c=c*c+a*a,c<=h&&p.push(o[l])}continue}a=Math.floor((c+g)/2);let k=s[2*a],x=s[2*a+1];{var n=k-e;let b=x-t;n=n*n+b*b}n<=h&&p.push(o[a]),n=(l+1)%2,(l===0?e-r<=k:t-r<=x)&&(d.push(c),d.push(a-1),d.push(n)),(l===0?e+r>=k:t+r>=x)&&(d.push(a+1),d.push(g),d.push(n))}e=p}return e}}let ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:i=>i},W=Math.fround||(i=>e=>(i[0]=+e,i[0]))(new Float32Array(1));class dt{constructor(e){this.options=U(Object.create(ut),e),this.trees=Array(this.options.maxZoom+1)}load(e){let{log:t,minZoom:r,maxZoom:o,nodeSize:s}=this.options;t&&console.time("total time");var u=`prepare ${e.length} points`;t&&console.time(u),this.points=e;let l=[];for(let c=0;c<e.length;c++)e[c].geometry&&l.push(ct(e[c],c));for(this.trees[o+1]=new xe(l,Ce,we,s,Float32Array),t&&console.timeEnd(u),e=o;e>=r;e--)u=+Date.now(),l=this._cluster(l,e),this.trees[e]=new xe(l,Ce,we,s,Float32Array),t&&console.log("z%d: %d clusters in %dms",e,l.length,+Date.now()-u);return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;var o=Math.max(-90,Math.min(90,e[1])),s=e[2]===180?180:((e[2]+180)%360+360)%360-180;let u=Math.max(-90,Math.min(90,e[3]));if(360<=e[2]-e[0])r=-180,s=180;else if(r>s){var l=this.getClusters([r,o,180,u],t);return o=this.getClusters([-180,o,s,u],t),l.concat(o)}t=this.trees[this._limitZoom(t)],s=t.range(r/360+.5,G(u),s/360+.5,G(o)),o=[];for(l of s)s=t.points[l],o.push(s.numPoints?_e(s):this.points[s.index]);return o}getChildren(e){var t=this._getOriginId(e),r=this._getOriginZoom(e);let o=this.trees[r];if(!o||(t=o.points[t],!t))throw Error("No cluster with the specified id.");t=o.within(t.x,t.y,this.options.radius/(this.options.extent*Math.pow(2,r-1))),r=[];for(let s of t)t=o.points[s],t.parentId===e&&r.push(t.numPoints?_e(t):this.points[t.index]);if(r.length===0)throw Error("No cluster with the specified id.");return r}getLeaves(e,t,r){let o=[];return this._appendLeaves(o,e,t||10,r||0,0),o}getTile(e,t,r){let o=this.trees[this._limitZoom(e)];e=Math.pow(2,e);let{extent:s,radius:u}=this.options,l=u/s,c=(r-l)/e,a=(r+1+l)/e,n={features:[]};return this._addTileFeatures(o.range((t-l)/e,c,(t+1+l)/e,a),o.points,t,r,e,n),t===0&&this._addTileFeatures(o.range(1-l/e,c,1,a),o.points,e,r,e,n),t===e-1&&this._addTileFeatures(o.range(0,c,l/e,a),o.points,-1,r,e,n),n.features.length?n:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom&&(e=this.getChildren(e),t++,e.length===1);)e=e[0].properties.cluster_id;return t}_appendLeaves(e,t,r,o,s){t=this.getChildren(t);for(let u of t)if((t=u.properties)&&t.cluster?s=s+t.point_count<=o?s+t.point_count:this._appendLeaves(e,t.cluster_id,r,o,s):s<o?s++:e.push(u),e.length===r)break;return s}_addTileFeatures(e,t,r,o,s,u){for(let a of e){e=t[a];let n=e.numPoints;var l=void 0;let d;var c=void 0;n?(l=qe(e),d=e.x,c=e.y):(c=this.points[e.index],l=c.properties,d=c.geometry.coordinates[0]/360+.5,c=G(c.geometry.coordinates[1])),l={type:1,geometry:[[Math.round(this.options.extent*(d*s-r)),Math.round(this.options.extent*(c*s-o))]],tags:l};let p;n?p=e.id:this.options.generateId?p=e.index:this.points[e.index].id&&(p=this.points[e.index].id),p!==void 0&&(l.id=p),u.features.push(l)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){let r=[],{radius:o,extent:s,reduce:u,minPoints:l}=this.options,c=o/(s*Math.pow(2,t));for(let h=0;h<e.length;h++){var a=e[h];if(a.zoom<=t)continue;a.zoom=t;let g=this.trees[t+1];var n=g.within(a.x,a.y,c),d=a.numPoints||1;let k=d;for(let x of n){var p=g.points[x];p.zoom>t&&(k+=p.numPoints||1)}if(k>d&&k>=l){p=a.x*d;let x=a.y*d;d=u&&1<d?this._map(a,!0):null;let b=(h<<5)+(t+1)+this.points.length;for(let ce of n){if(n=g.points[ce],n.zoom<=t)continue;n.zoom=t;let Y=n.numPoints||1;p+=n.x*Y,x+=n.y*Y,n.parentId=b,u&&(d||(d=this._map(a,!0)),u(d,this._map(n)))}a.parentId=b,r.push(pt(p/k,x/k,b,k,d))}else if(r.push(a),1<k)for(let x of n)a=g.points[x],a.zoom<=t||(a.zoom=t,r.push(a))}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?U({},e.properties):e.properties;e=this.points[e.index].properties;let r=this.options.map(e);return t&&r===e?U({},r):r}}function pt(i,e,t,r,o){return{x:W(i),y:W(e),zoom:1/0,id:t,parentId:-1,numPoints:r,properties:o}}function ct(i,e){let[t,r]=i.geometry.coordinates;return{x:W(t/360+.5),y:W(G(r)),zoom:1/0,index:e,parentId:-1}}function _e(i){var e=i.id,t=qe(i);return{type:"Feature",id:e,properties:t,geometry:{type:"Point",coordinates:[360*(i.x-.5),360*Math.atan(Math.exp((180-360*i.y)*Math.PI/180))/Math.PI-90]}}}function qe(i){let e=i.numPoints,t=1e4<=e?`${Math.round(e/1e3)}k`:1e3<=e?`${Math.round(e/100)/10}k`:e;return U(U({},i.properties),{cluster:!0,cluster_id:i.id,point_count:e,point_count_abbreviated:t})}function G(i){return i=Math.sin(i*Math.PI/180),i=.5-.25*Math.log((1+i)/(1-i))/Math.PI,0>i?0:1<i?1:i}function U(i,e){for(let t in e)i[t]=e[t];return i}function Ce(i){return i.x}function we(i){return i.y}class re{constructor({markers:e,position:t}){this.markers=e,t&&(this._position=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t))}get bounds(){if(this.markers.length!==0||this._position)return this.markers.reduce((e,t)=>e.extend(t.getPosition()),new google.maps.LatLngBounds(this._position,this._position))}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>e.getVisible()).length}push(e){this.markers.push(e)}delete(){this.marker&&(this.marker.setMap(null),delete this.marker),this.markers.length=0}}class mt{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return ht(e)}}let ht=i=>i.map(e=>new re({position:e.getPosition(),markers:[e]}));class ft extends mt{constructor(e){var{maxZoom:t,radius:r=60}=e,o=["maxZoom","radius"],s={},u;for(u in e)Object.prototype.hasOwnProperty.call(e,u)&&0>o.indexOf(u)&&(s[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(u=Object.getOwnPropertySymbols(e);l<u.length;l++)0>o.indexOf(u[l])&&Object.prototype.propertyIsEnumerable.call(e,u[l])&&(s[u[l]]=e[u[l]])}super({maxZoom:t}),this.superCluster=new dt(Object.assign({maxZoom:this.maxZoom,radius:r},s)),this.state={zoom:null}}calculate(e){let t=!1;if(!D(e.markers,this.markers)){t=!0,this.markers=[...e.markers];var r=this.markers.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.getPosition().lng(),o.getPosition().lat()]},properties:{marker:o}}));this.superCluster.load(r)}return r={zoom:e.map.getZoom()},t||this.state.zoom>this.maxZoom&&r.zoom>this.maxZoom||(t=t||!D(this.state,r)),this.state=r,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(this.transformCluster.bind(this))}transformCluster({geometry:{coordinates:[e,t]},properties:r}){return r.cluster?new re({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(o=>o.properties.marker),position:new google.maps.LatLng({lat:t,lng:e})}):(e=r.marker,new re({markers:[e],position:e.getPosition()}))}}class vt{constructor(e,t){this.markers={sum:e.length},e=t.map(o=>o.count);let r=e.reduce((o,s)=>o+s,0);this.clusters={count:t.length,markers:{mean:r/t.length,sum:r,min:Math.min(...e),max:Math.max(...e)}}}}class gt{render({count:e,position:t},r){return r=window.btoa(`
  <svg fill="${e>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240">
    <circle cx="120" cy="120" opacity=".6" r="70" />
    <circle cx="120" cy="120" opacity=".3" r="90" />
    <circle cx="120" cy="120" opacity=".2" r="110" />
  </svg>`),new google.maps.Marker({position:t,icon:{url:`data:image/svg+xml;base64,${r}`,scaledSize:new google.maps.Size(45,45)},label:{text:String(e),color:"rgba(255,255,255,0.9)",fontSize:"12px"},title:`Cluster of ${e} markers`,zIndex:Number(google.maps.Marker.MAX_ZINDEX)+e})}}class de{constructor(){var e=de,t=google.maps.OverlayView;for(let r in t.prototype)e.prototype[r]=t.prototype[r]}}var V,pe=V||(V={});pe.CLUSTERING_BEGIN="clusteringbegin";pe.CLUSTERING_END="clusteringend";pe.CLUSTER_CLICK="click";let yt=(i,e,t)=>{t.fitBounds(e.bounds)};class kt extends de{constructor({map:e,markers:t=[],algorithm:r=new ft({}),renderer:o=new gt,onClusterClick:s=yt}){super(),this.markers=[...t],this.clusters=[],this.algorithm=r,this.renderer=o,this.onClusterClick=s,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(r=>{this.addMarker(r,!0)}),t||this.render()}removeMarker(e,t){let r=this.markers.indexOf(e);return r===-1?!1:(e.setMap(null),this.markers.splice(r,1),t||this.render(),!0)}removeMarkers(e,t){let r=!1;return e.forEach(o=>{r=this.removeMarker(o,!0)||r}),r&&!t&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){let e=this.getMap();if(e instanceof google.maps.Map&&this.getProjection()){google.maps.event.trigger(this,V.CLUSTERING_BEGIN,this);let{clusters:t,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});(r||r==null)&&(this.reset(),this.clusters=t,this.renderClusters()),google.maps.event.trigger(this,V.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>e.setMap(null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){let e=new vt(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,e),this.onClusterClick&&r.marker.addListener("click",o=>{google.maps.event.trigger(this,V.CLUSTER_CLICK,r),this.onClusterClick(o,r,t)})),r.marker.setMap(t)})}}let Me=Object.values(V);S({name:"MarkerCluster",props:{options:{type:Object,default:()=>({})}},emits:Me,setup(i,{emit:e,expose:t,slots:r}){let o=y(),s=M(B,y()),u=M(A,y());return F(je,o),E(s,()=>{s.value&&(o.value=I(new kt({map:s.value,...i.options})),Me.forEach(l=>{var c;(c=o.value)===null||c===void 0||c.addListener(l,a=>e(l,a))}))},{immediate:!0}),N(()=>{var l;o.value&&((l=u.value)===null||l===void 0||l.event.clearInstanceListeners(o.value),o.value.clearMarkers(),o.value.setMap(null))}),t({markerCluster:o}),()=>{var l;return(l=r.default)===null||l===void 0?void 0:l.call(r)}}});var $e=S({inheritAttrs:!1,props:{options:{type:Object,required:!0}},setup(i,{slots:e,emit:t}){let r=y(),o=y(),s=H(()=>{var l;return(l=e.default)===null||l===void 0?void 0:l.call(e).some(c=>c.type!==Ee)}),u=H(()=>({...i.options,element:r.value}));return ne(()=>{o=R(J,[],u,t)}),{customMarkerRef:r,customMarker:o,hasSlotContent:s}}});ue(`
.custom-marker-wrapper[data-v-b9d5ec8a] {
  display: none;
}
.mapdiv .custom-marker-wrapper[data-v-b9d5ec8a] {
  display: inline-block;
}
`);let xt=oe();ie("data-v-b9d5ec8a");let _t={key:0,class:"custom-marker-wrapper"};se();let Ct=xt(i=>i.hasSlotContent?(C(),L("div",_t,[f("div",Oe({ref:"customMarkerRef",style:{cursor:i.$attrs.onClick?"pointer":void 0}},i.$attrs),[X(i.$slots,"default",{},void 0,!0)],16)])):O("v-if",!0));$e.render=Ct;$e.__scopeId="data-v-b9d5ec8a";S({name:"HeatmapLayer",props:{options:{type:Object,default:()=>({})}},setup(i){let e=y(),t=M(B,y()),r=M(A,y());return E([t,()=>i.options],([,o],[s,u])=>{var l;if(s=!D(o,u)||t.value!==s,t.value&&r.value&&s){if(o=structuredClone(o),o.data&&!(o.data instanceof r.value.MVCArray)){let c=r.value.LatLng;o.data=(l=o.data)===null||l===void 0?void 0:l.map(a=>a instanceof c||"location"in a&&(a.location instanceof c||a.location===null)?a:"location"in a?{...a,location:new c(a.location)}:new c(a))}e.value?e.value.setOptions(o):e.value=I(new r.value.visualization.HeatmapLayer({...o,map:t.value}))}},{immediate:!0}),N(()=>{e.value&&e.value.setMap(null)}),{heatmapLayer:e}},render:()=>null});const wt={__name:"MapView",emits:["onMapClicked"],setup(i,{emit:e}){const t="AIzaSyDzSKURg3HghZ-Jv_FfoXWVlMoGVDAvuBU",r=le(),o=s=>{r.editMap&&r.$patch({form:{...r.form,coords:[...r.form.coords,{lat:s.latLng.lat(),lng:s.latLng.lng()}]}})};return(s,u)=>(C(),L(m(ae),{onClick:o,"api-key":t,style:{width:"100%",height:"500px"},center:m(r).center,zoom:10,"draggable-cursor":"pointer"},{default:_(()=>[f(m(tt),{options:{paths:m(r).form.coords,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}},null,8,["options"])]),_:1},8,["center"]))}},Mt={class:"text-h6"},bt={key:0,class:"text-xs mx-3 mt-1 text-red-500"},St={class:"flex flex-row items-center justify-between mt-2"},Ot=v("p",{class:""},"Reset",-1),Et={class:"text-white"},Pt={key:0,class:"text-xs mx-1 mt-1 text-red-500"},It={key:1,class:"text-xs mx-1 mt-1 text-red-500"},Lt=v("option",{value:"gbp"},"GBP",-1),jt=v("option",{value:"usd"},"USD",-1),zt={key:2,class:"text-xs mx-1 mt-1 text-red-500"},Tt=v("option",{value:"km"},"Kilometers",-1),Vt=v("option",{value:"mi"},"Miles",-1),qt={key:3,class:"text-xs mx-1 mt-1 text-red-500"},$t={key:4,class:"text-xs mx-1 mt-1 text-red-500"},Nt={class:"flex space-x-4 pt-5"},Bt=v("p",{class:"text-black"},"Cancel",-1),At={__name:"AddCity",props:{country:Object},setup(i){const e=le(),t=()=>{e.form.post(route("cities.store",{id:e.form.country_id}),{preserveScroll:!0,onSuccess:()=>{e.form.reset(),e.dialog=!1}})},r=()=>{e.form.post(route("cities.update",{id:e.form.id}),{preserveScroll:!0,onSuccess:()=>{e.form.reset(),e.dialog=!1,e.isEdit=!1}})};return(o,s)=>{const u=z("VCardTitle"),l=z("VContainer"),c=z("VCard"),a=z("VDialog");return C(),L(a,{modelValue:m(e).dialog,"onUpdate:modelValue":s[9]||(s[9]=n=>m(e).dialog=n),persistent:"","max-width":"700"},{default:_(()=>[f(c,{class:"w-full"},{default:_(()=>[f(u,{class:"pt-4"},{default:_(()=>[v("span",Mt,w(m(e).isEdit?"Edit City":"Add City"),1)]),_:1}),f(wt),m(e).form.errors.coords?(C(),P("p",bt,w(m(e).form.errors.coords),1)):O("",!0),v("div",St,[f(T,{onClick:s[0]||(s[0]=n=>m(e).$patch({form:{...m(e).form,coords:[]}})),type:"button",class:"mx-3 bg-slate-200 hover:bg-slate-300 w-full flex items-center justify-center"},{default:_(()=>[Ot]),_:1}),f(T,{onClick:s[1]||(s[1]=n=>m(e).$patch({editMap:!m(e).editMap})),type:"button",class:Ze(["mx-3 bg-red-500 hover:bg-slate-300 w-full flex items-center justify-center",{"bg-green-500 ":m(e).editMap}])},{default:_(()=>[v("p",Et," Edit Map "+w(m(e).editMap?"ON":"OFF"),1)]),_:1},8,["class"])]),f(l,{class:"pt-4"},{default:_(()=>[v("form",{onSubmit:s[8]||(s[8]=Pe(n=>m(e).isEdit?r():t(),["prevent"])),class:"space-y-2"},[f(K,{modelValue:m(e).form.name,"onUpdate:modelValue":s[2]||(s[2]=n=>m(e).form.name=n),placeholder:"Name",class:"w-full py-2 px-3"},null,8,["modelValue"]),m(e).form.errors.name?(C(),P("p",Pt,w(m(e).form.errors.name),1)):O("",!0),f(K,{modelValue:m(e).form.zipcode,"onUpdate:modelValue":s[3]||(s[3]=n=>m(e).form.zipcode=n),placeholder:"Zip Code",class:"w-full py-2 px-3"},null,8,["modelValue"]),m(e).form.errors.zipcode?(C(),P("p",It,w(m(e).form.errors.zipcode),1)):O("",!0),f(me,{modelValue:m(e).form.currency,"onUpdate:modelValue":s[4]||(s[4]=n=>m(e).form.currency=n),title:"Currency"},{default:_(()=>[Lt,jt]),_:1},8,["modelValue"]),m(e).form.errors.currency?(C(),P("p",zt,w(m(e).form.errors.currency),1)):O("",!0),f(me,{modelValue:m(e).form.unit,"onUpdate:modelValue":s[5]||(s[5]=n=>m(e).form.unit=n),title:"Select Distance Unit",disabled:""},{default:_(()=>[Tt,Vt]),_:1},8,["modelValue"]),m(e).form.errors.unit?(C(),P("p",qt,w(m(e).form.errors.unit),1)):O("",!0),f(K,{modelValue:m(e).form.radius,"onUpdate:modelValue":s[6]||(s[6]=n=>m(e).form.radius=n),placeholder:"Radius",class:"w-full py-2 px-3"},null,8,["modelValue"]),m(e).form.errors.radius?(C(),P("p",$t,w(m(e).form.errors.radius),1)):O("",!0),v("div",Nt,[f(T,{onClick:s[7]||(s[7]=n=>m(e).dialog=!1),type:"button",secondary:"",class:"w-full flex items-center justify-center"},{default:_(()=>[Bt]),_:1}),f(T,{class:"w-full flex items-center justify-center"},{default:_(()=>[Ie(w(m(e).isEdit?"Update":"Submit"),1)]),_:1})])],32)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Rt={class:"flex flex-row justify-between items-center w-full py-2 pb-5"},Zt={class:"flex space-x-2"},Ft={class:""},Ut=v("thead",null,[v("tr",{class:"bg-[#1D1C1C] text-white"},[v("th",null,"Name"),v("th",null,"Zip Code"),v("th",null,"Currency"),v("th",null,"Radius"),v("th",null,"Unit Distance"),v("th",{class:"w-40"},"Action")])],-1),Dt={class:"flex flex-row w-28"},tr={__name:"Cities",props:{country:Object,cities:Array,search:Boolean},setup(i){const e=i,t=le(),r=be({search:""}),{alert:o}=He(),s=c=>{o(null,"this action will delete city",null,"Yes , do it!").then(({isConfirmed:a})=>a?t.form.delete(route("cities.delete",{id:c})):null)},u=()=>{r.get(route("cities",{country:e.country.id}))},l=()=>{r.search="",u()};return(c,a)=>{const n=z("VIcon"),d=z("VBtn");return C(),L(Ke,{isBack:"",title:i.country.name},{default:_(()=>[f(m(Fe),{title:i.country.name},null,8,["title"]),v("div",Rt,[Ie(" ' "),v("form",{onSubmit:a[2]||(a[2]=Pe(p=>u(),["prevent"]))},[v("div",Zt,[f(K,{type:"search",class:"bg-slate-200",placeholder:"Search City...",modelValue:m(r).search,"onUpdate:modelValue":a[0]||(a[0]=p=>m(r).search=p)},null,8,["modelValue"]),v("div",Ft,[f(T,{type:"submit",class:"h-10 w-10 flex items-center justify-center"},{default:_(()=>[f(n,{icon:"mdi-magnify"})]),_:1})]),f(T,{type:"submit",onClick:a[1]||(a[1]=p=>l()),class:"h-10 w-10 flex items-center justify-center active:bg-slate-300",secondary:""},{default:_(()=>[f(n,{color:"black",icon:"mdi-close"})]),_:1})])],32),f(d,{onClick:a[3]||(a[3]=()=>{m(t).form.reset(),m(t).form.country_id=i.country.id,m(t).isEdit=!1,m(t).dialog=!0}),icon:"mdi-plus",color:"black",class:"ml-auto"})]),f(Ge,{class:"rounded border"},{default:_(()=>[Ut,v("tbody",null,[(C(!0),P(Se,null,Ue(i.search?i.cities:i.cities.data,p=>(C(),P("tr",{key:p.id},[v("td",null,w(p.name),1),v("td",null,w(p.zipcode),1),v("td",null,w(p.currency),1),v("td",null,w(p.radius),1),v("td",null,w(p.unit),1),v("td",Dt,[f(Q,{onClick:h=>s(p.id),isDelete:!0},null,8,["onClick"]),f(Q,{onClick:()=>{var h,g;m(t).form.country_id=p.country_id,m(t).form.radius=p.radius,m(t).form.id=p.id,m(t).form.name=p.name,m(t).form.zipcode=p.zipcode,m(t).form.currency=p.currency,m(t).form.unit=p.unit,m(t).form.coords=p.coords?JSON.parse(p.coords):[],m(t).isEdit=!0,m(t).dialog=!0,m(t).center=p.coords?{lat:(h=JSON.parse(p.coords)[0])==null?void 0:h.lat,lng:(g=JSON.parse(p.coords)[0])==null?void 0:g.lng}:{lat:57.477772,lng:-4.224721}},isEdit:!0},null,8,["onClick"]),f(m(De),{as:"button",href:`/${p.id}/vehicles`},{default:_(()=>[f(Q,{isView:!0})]),_:2},1032,["href"])])]))),128))])]),_:1}),i.search?O("",!0):(C(),L(Je,{key:0,links:i.cities.links},null,8,["links"])),f(At,{country:i.country},null,8,["country"])]),_:1},8,["title"])}}};export{tr as default};
